®
TC:\Users\Cam\source\repos\cgoncalves\Utils\CSVFileHandler\ReadWithTextFieldParser.cs
	namespace 	
Utils
 
. 
CSVFileHandler 
{ 
public 

class #
ReadWithTextFieldParser (
{ 
public		 
static		 
List		 
<		 
BookDTO		 "
>		" #
ReadCsv		$ +
(		+ ,
string		, 2
path		3 7
)		7 8
{

 	
var 
books 
= 
new 
List  
<  !
BookDTO! (
>( )
() *
)* +
;+ ,
using 
( 
var 
parser 
= 
new  #
TextFieldParser$ 3
(3 4
path4 8
)8 9
)9 :
{ 
parser 
. 
TextFieldType $
=% &
	FieldType' 0
.0 1
	Delimited1 :
;: ;
parser 
. 
SetDelimiters $
($ %
$str% (
)( )
;) *
parser 
. 
ReadLine 
(  
)  !
;! "
while 
( 
! 
parser 
. 
	EndOfData (
)( )
{ 
string 
[ 
] 
fields #
=$ %
parser& ,
., -

ReadFields- 7
(7 8
)8 9
;9 :
if 
( 
fields 
. 
Length %
>=& (
$num) *
)* +
{ 
var 
book  
=! "
new# &
BookDTO' .
{ 
IdBook "
=# $
int% (
.( )
TryParse) 1
(1 2
fields2 8
[8 9
$num9 :
]: ;
,; <
out= @
intA D
idE G
)G H
?I J
idK M
:N O
$numP Q
,Q R
Tittle "
=# $
fields% +
[+ ,
$num, -
]- .
,. /
	Publisher %
=& '
fields( .
[. /
$num/ 0
]0 1
} 
; 
books   
.   
Add   !
(  ! "
book  " &
)  & '
;  ' (
}!! 
}"" 
}## 
return%% 
books%% 
;%% 
}&& 	
public'' 
static'' 
string'' 
SearchFileAddress'' .
(''. /
	IFormFile''/ 8
file''9 =
)''= >
{(( 	
var)) 
tempPath)) 
=)) 
Path)) 
.))  
GetTempFileName))  /
())/ 0
)))0 1
;))1 2
using** 
(** 
var** 
stream** 
=** 
new**  #

FileStream**$ .
(**. /
tempPath**/ 7
,**7 8
FileMode**9 A
.**A B
Create**B H
)**H I
)**I J
{++ 
file,, 
.,, 
CopyTo,, 
(,, 
stream,, "
),," #
;,,# $
}-- 
return.. 
tempPath.. 
;.. 
}// 	
}00 
}11 ó
JC:\Users\Cam\source\repos\cgoncalves\Utils\CustomValidator\DTOValidator.cs
	namespace 	
Utils
 
. 
CustomValidator 
{ 
public 

class 
CustomValidator  
<  !
T! "
>" #
{ 
public 
static 
void 
DTOValidator '
(' (
T( )
dto* -
)- .
{		 	
if

 
(

 
dto

 
==

 
null

 
)

 
{ 
throw 
new 
BadRequestException -
(- .
$". 0
$str0 g
"g h
)h i
;i j
} 
var 
validationResults !
=" #
new$ '
List( ,
<, -
ValidationResult- =
>= >
(> ?
)? @
;@ A
bool 
isValid 
= 
	Validator $
.$ %
TryValidateObject% 6
(6 7
dto7 :
,: ;
new< ?
ValidationContext@ Q
(Q R
dtoR U
)U V
,V W
validationResultsX i
,i j
truek o
)o p
;p q
if 
( 
! 
isValid 
) 
{ 
throw 
new 
BadRequestException -
(- .
$". 0
{0 1
validationResults1 B
[B C
$numC D
]D E
.E F
ErrorMessageF R
}R S
"S T
)T U
;U V
} 
} 	
} 
} ˆ

LC:\Users\Cam\source\repos\cgoncalves\Utils\Exceptions\BadRequestException.cs
	namespace 	
Utils
 
. 

Exceptions 
{ 
public 

class 
BadRequestException $
:% &
	Exception' 0
{ 
public 
BadRequestException "
(" #
)# $
:% &
base' +
(+ ,
), -
{ 	
}		 	
public

 
BadRequestException

 "
(

" #
string

# )
message

* 1
)

1 2
:

3 4
base

5 9
(

9 :
message

: A
)

A B
{ 	
} 	
public 
BadRequestException "
(" #
string# )
message* 1
,1 2
params3 9
object: @
[@ A
]A B
argsC G
)G H
:I J
baseK O
(O P
StringP V
.V W
FormatW ]
(] ^
CultureInfo^ i
.i j
CurrentCulturej x
,x y
message	z 
,
 ‚
args
ƒ ‡
)
‡ ˆ
)
ˆ ‰
{ 	
} 	
} 
} ®
IC:\Users\Cam\source\repos\cgoncalves\Utils\Exceptions\ExceptionMessage.cs
	namespace 	
TestApiRest
 
. 

Exceptions  
{ 
public 

class 
ExceptionMessage !
:" #
	Exception$ -
{ 
public 
ExceptionMessage 
(  
string  &
message' .
). /
:0 1
base2 6
(6 7
message7 >
)> ?
{ 	
}		 	
}

 
} é
LC:\Users\Cam\source\repos\cgoncalves\Utils\Middleware\ValidatorMiddleware.cs
	namespace 	
Utils
 
. 

Middleware 
{ 
public 

class 
ValidatorMiddleware $
{		 
private

 
readonly

 
RequestDelegate

 (
_next

) .
;

. /
public 
ValidatorMiddleware "
(" #
RequestDelegate# 2
next3 7
)7 8
{ 	
_next 
= 
next 
; 
} 	
public 
async 
Task 
Invoke  
(  !
HttpContext! ,
context- 4
)4 5
{ 	
try 
{ 
await 
_next 
( 
context #
)# $
;$ %
} 
catch 
( 
	Exception 
ex 
)  
{ 
if 
( 
ex 
. 
InnerException $
is% ' 
KeyNotFoundException( <
)< =
{ 
ex 
= 
ex 
. 
InnerException *
as+ - 
KeyNotFoundException. B
;B C
} 
if 
( 
ex 
. 
InnerException $
is% '
BadRequestException( ;
); <
{ 
ex 
= 
ex 
. 
InnerException *
as+ -
BadRequestException. A
;A B
} 
var   
resp   
=   
context   "
.  " #
Response  # +
;  + ,
resp!! 
.!! 
ContentType!!  
=!!! "
$str!!# 5
;!!5 6
var"" 
	respModel"" 
="" 
ex""  "
.""" #
Message""# *
;""* +
switch## 
(## 
ex## 
)## 
{$$ 
case%% 
BadRequestException%% ,
e%%- .
:%%. /
resp&& 
.&& 

StatusCode&& '
=&&( )
(&&* +
int&&+ .
)&&. /
HttpStatusCode&&/ =
.&&= >

BadRequest&&> H
;&&H I
break'' 
;'' 
case((  
KeyNotFoundException(( -
e((. /
:((/ 0
resp)) 
.)) 

StatusCode)) '
=))( )
())* +
int))+ .
))). /
HttpStatusCode))/ =
.))= >
NotFound))> F
;))F G
break** 
;** 
default++ 
:++ 
resp,, 
.,, 

StatusCode,, '
=,,( )
(,,* +
int,,+ .
),,. /
HttpStatusCode,,/ =
.,,= >
InternalServerError,,> Q
;,,Q R
break-- 
;-- 
}.. 
var// 
result// 
=// 
JsonSerializer// +
.//+ ,
	Serialize//, 5
(//5 6
	respModel//6 ?
)//? @
;//@ A
await00 
resp00 
.00 

WriteAsync00 %
(00% &
result00& ,
)00, -
;00- .
}11 
}22 	
}33 
}44 é8
SC:\Users\Cam\source\repos\cgoncalves\Utils\PDFFileHandler\CreateWithPDFSharpCore.cs
	namespace 	
Utils
 
. 
PDFFileHandler 
{ 
public 

class "
CreateWithPDFSharpCore '
{ 
public 
static 
byte 
[ 
] 
	CreatePDF &
(& '
string' -
path. 2
,2 3
OrderDTO4 <
order= B
,B C
UserDTOD K
userL P
,P Q
ListR V
<V W
OrderDetailDTOW e
>e f
orderDetailsg s
,s t
Listu y
<y z
BookDTO	z 
>
 ‚
books
ƒ ˆ
)
ˆ ‰
{ 	
using 
var 
memoryStream "
=# $
new% (
MemoryStream) 5
(5 6
)6 7
;7 8
var 
document 
= 
new 
PdfDocument *
(* +
)+ ,
;, -
var 
page 
= 
document 
.  
AddPage  '
(' (
)( )
;) *
var 
gfx 
= 
	XGraphics 
.  
FromPdfPage  +
(+ ,
page, 0
)0 1
;1 2
XFont 
	titleFont 
= 
new !
XFont" '
(' (
$str( /
,/ 0
$num1 3
,3 4

XFontStyle5 ?
.? @
Bold@ D
)D E
;E F
XFont 

normalFont 
= 
new "
XFont# (
(( )
$str) 0
,0 1
$num2 4
)4 5
;5 6
gfx 
. 

DrawString 
( 
$str 3
,3 4
	titleFont5 >
,> ?
XBrushes@ H
.H I
BlackI N
,N O
newP S
XRectT Y
(Y Z
$numZ \
,\ ]
$num^ `
,` a
pageb f
.f g
Widthg l
,l m
$numn p
)p q
,q r
XStringFormats	s 
.
 ‚
TopLeft
‚ ‰
)
‰ Š
;
Š ‹
gfx 
. 

DrawString 
( 
$" 
$str /
{/ 0
order0 5
.5 6
IdOrder6 =
}= >
"> ?
,? @

normalFontA K
,K L
XBrushesM U
.U V
BlackV [
,[ \
$num] _
,_ `
$numa c
)c d
;d e
gfx 
. 

DrawString 
( 
$" 
$str /
{/ 0
order0 5
.5 6
DateOfOrder6 A
.A B
ToShortDateStringB S
(S T
)T U
}U V
"V W
,W X

normalFontY c
,c d
XBrushese m
.m n
Blackn s
,s t
$numu w
,w x
$numy |
)| }
;} ~
if 
( 
user 
!= 
null 
) 
{ 
gfx 
. 

DrawString 
( 
$" !
$str! )
{) *
user* .
.. /
Name/ 3
}3 4
$str4 5
{5 6
user6 :
.: ;
Surname; B
}B C
"C D
,D E

normalFontF P
,P Q
XBrushesR Z
.Z [
Black[ `
,` a
$numb d
,d e
$numf h
)h i
;i j
gfx   
.   

DrawString   
(   
$"   !
$str  ! 6
{  6 7
user  7 ;
.  ; <
DocumentNumber  < J
}  J K
"  K L
,  L M

normalFont  N X
,  X Y
XBrushes  Z b
.  b c
Black  c h
,  h i
$num  j l
,  l m
$num  n q
)  q r
;  r s
}!! 
gfx## 
.## 

DrawString## 
(## 
$str## 1
,##1 2

normalFont##3 =
,##= >
XBrushes##? G
.##G H
Black##H M
,##M N
$num##O Q
,##Q R
$num##S V
)##V W
;##W X
int%% 
yOffset%% 
=%% 
$num%% 
;%% 
foreach'' 
('' 
var'' 
detail'' 
in''  "
orderDetails''# /
)''/ 0
{(( 
var)) 
book)) 
=)) 
books))  
.))  !
FirstOrDefault))! /
())/ 0
b))0 1
=>))2 4
b))5 6
.))6 7
IdBook))7 =
==))> @
detail))A G
.))G H
IdBook))H N
)))N O
;))O P
if** 
(** 
book** 
!=** 
null**  
)**  !
{++ 
gfx,, 
.,, 

DrawString,, "
(,," #
$",,# %
$str,,% 7
{,,7 8
book,,8 <
.,,< =
Tittle,,= C
},,C D
",,D E
,,,E F

normalFont,,G Q
,,,Q R
XBrushes,,S [
.,,[ \
Black,,\ a
,,,a b
$num,,c e
,,,e f
yOffset,,g n
+,,o p
$num,,q s
),,s t
;,,t u
gfx-- 
.-- 

DrawString-- "
(--" #
$"--# %
$str--% 6
{--6 7
book--7 ;
.--; <
	Publisher--< E
}--E F
"--F G
,--G H

normalFont--I S
,--S T
XBrushes--U ]
.--] ^
Black--^ c
,--c d
$num--e g
,--g h
yOffset--i p
+--q r
$num--s u
)--u v
;--v w
}.. 
yOffset// 
+=// 
$num// 
;// 
}00 
document22 
.22 
Save22 
(22 
memoryStream22 &
)22& '
;22' (
return33 
memoryStream33 
.33  
ToArray33  '
(33' (
)33( )
;33) *
}44 	
public66 
static66 
string66 
GeneratePath66 )
(66) *
string66* 0
folder661 7
)667 8
{77 	
string88 
baseDirectory88  
=88! "
	AppDomain88# ,
.88, -
CurrentDomain88- :
.88: ;
BaseDirectory88; H
;88H I
string99 
fullpath99 
=99 
Path99 "
.99" #
Combine99# *
(99* +
baseDirectory99+ 8
,998 9
folder99: @
)99@ A
;99A B
return:: 
fullpath:: 
;:: 
};; 	
}<< 
}== 